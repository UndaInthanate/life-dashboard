<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>à¸ªà¸¸à¸‚à¸ à¸²à¸ | Life Dashboard</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body class="dark-mode">
  <div class="sidebar">
    <div class="sidebar-header">
      <h2>ğŸ’° Life Dashboard</h2>
      <div class="theme-controls">
        <button class="theme-toggle">ğŸŒ“</button>
        <button class="lang-toggle">ğŸ‡¬ğŸ‡§ EN</button>
      </div>
    </div>
    <nav class="sidebar-nav">
      <div class="nav-group">
        <div class="nav-group-title">ğŸ’° à¸à¸²à¸£à¹€à¸‡à¸´à¸™</div>
        <a href="/" class="nav-item">
          <span>ğŸ“Š</span> à¸ à¸²à¸à¸£à¸§à¸¡
        </a>
        <a href="/transactions" class="nav-item">
          <span>ğŸ§¾</span> à¸˜à¸¸à¸£à¸à¸£à¸£à¸¡
        </a>
        <a href="/debts" class="nav-item">
          <span>âš ï¸</span> à¸«à¸™à¸µà¹‰à¸ªà¸´à¸™
        </a>
        <a href="/fixed-expenses" class="nav-item">
          <span>ğŸ“Œ</span> à¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢à¸„à¸‡à¸—à¸µà¹ˆ
        </a>
        <a href="/categories" class="nav-item">
          <span>ğŸ·ï¸</span> à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ
        </a>
        <a href="/settings" class="nav-item">
          <span>âš™ï¸</span> à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²
        </a>
      </div>
      <div class="nav-group">
        <div class="nav-group-title">ğŸ’ª à¸ªà¸¸à¸‚à¸ à¸²à¸</div>
        <a href="/health" class="nav-item <%= activePage === 'health' ? 'active' : '' %>">
          <span>ğŸƒ</span> à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢
        </a>
      </div>
      <div class="nav-group">
        <div class="nav-group-title">ğŸ“ˆ à¸«à¸¸à¹‰à¸™</div>
        <a href="/stocks" class="nav-item <%= activePage === 'stocks' ? 'active' : '' %>">
          <span>ğŸ’¹</span> à¸à¸­à¸£à¹Œà¸•à¹‚à¸Ÿà¸¥à¸´à¹‚à¸­
        </a>
      </div>
      <div class="nav-group">
        <div class="nav-group-title">ğŸ¯ à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢</div>
        <a href="/goals" class="nav-item <%= activePage === 'goals' ? 'active' : '' %>">
          <span>ğŸ“</span> à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢
        </a>
      </div>
    </nav>
  </div>

  <div class="main-content">
    <div class="top-bar">
      <h1>ğŸ’ª à¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£à¸ªà¸¸à¸‚à¸ à¸²à¸à¹à¸¥à¸°à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢</h1>
    </div>

    <div class="dashboard-grid">
      <div class="card">
        <h2>ğŸ“‹ à¹€à¸à¸´à¹ˆà¸¡à¹à¸œà¸™à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢</h2>
        <form method="POST" action="/add-workout-plan" class="form-inline">
          <input type="text" name="name" placeholder="à¸Šà¸·à¹ˆà¸­à¹à¸œà¸™ (à¹€à¸Šà¹ˆà¸™ Push Day, Leg Day)" required>
          <select name="type" required>
            <option value="weight">à¹€à¸§à¸—</option>
            <option value="cardio">à¸§à¸´à¹ˆà¸‡/à¸„à¸²à¸£à¹Œà¸”à¸´à¹‚à¸­</option>
            <option value="mixed">à¸œà¸ªà¸¡</option>
          </select>
          <input type="text" name="target" placeholder="à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢ (à¹€à¸Šà¹ˆà¸™ à¸«à¸™à¹‰à¸²à¸­à¸, à¸‚à¸²)">
          <input type="text" name="note" placeholder="à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸">
          <button type="submit">à¹€à¸à¸´à¹ˆà¸¡à¹à¸œà¸™</button>
        </form>
      </div>

      <div class="card">
        <h2>âœï¸ à¸šà¸±à¸™à¸—à¸¶à¸à¸à¸²à¸£à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢</h2>
        <form method="POST" action="/add-workout-log" class="form-inline" id="workout-form">
          <input type="date" name="date" required>
          <select name="type" id="workout-type" required>
            <option value="weight">à¹€à¸§à¸—</option>
            <option value="cardio">à¸§à¸´à¹ˆà¸‡/à¸„à¸²à¸£à¹Œà¸”à¸´à¹‚à¸­</option>
          </select>
          <input type="text" name="exercise" placeholder="à¸Šà¸·à¹ˆà¸­à¸—à¹ˆà¸²/à¸à¸´à¸ˆà¸à¸£à¸£à¸¡" required>
          
          <!-- Fields for weight training -->
          <div class="weight-fields">
            <input type="number" step="0.1" name="weight" placeholder="à¸™à¹‰à¸³à¸«à¸™à¸±à¸ (kg)">
            <input type="number" name="sets" placeholder="à¹€à¸‹à¸•">
            <input type="number" name="reps" placeholder="à¸„à¸£à¸±à¹‰à¸‡">
          </div>
          
          <!-- Fields for cardio -->
          <div class="cardio-fields" style="display: none;">
            <input type="number" name="duration" placeholder="à¹€à¸§à¸¥à¸² (à¸™à¸²à¸—à¸µ)">
            <input type="number" step="0.01" name="distance" placeholder="à¸£à¸°à¸¢à¸°à¸—à¸²à¸‡ (km)">
          </div>
          
          <input type="number" name="calories" placeholder="à¹à¸„à¸¥à¸­à¸£à¸µà¹ˆ">
          <input type="text" name="note" placeholder="à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸">
          <button type="submit">à¸šà¸±à¸™à¸—à¸¶à¸</button>
        </form>
      </div>
    </div>

    <div class="dashboard-tables">
      <div class="table-section">
        <h2>ğŸ“‹ à¹à¸œà¸™à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢</h2>
        <table>
          <tr>
            <th>à¸Šà¸·à¹ˆà¸­à¹à¸œà¸™</th>
            <th>à¸›à¸£à¸°à¹€à¸ à¸—</th>
            <th>à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢</th>
            <th>à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸</th>
          </tr>
          <% workout_plans.forEach(p => { %>
            <tr>
              <td><%= p.name %></td>
              <td>
                <span class="badge-type <%= p.type %>">
                  <%= p.type === 'weight' ? 'ğŸ‹ï¸ à¹€à¸§à¸—' : p.type === 'cardio' ? 'ğŸƒ à¸§à¸´à¹ˆà¸‡' : 'ğŸ”„ à¸œà¸ªà¸¡' %>
                </span>
              </td>
              <td><%= p.target || '-' %></td>
              <td><%= p.note || '-' %></td>
            </tr>
          <% }) %>
        </table>
      </div>

      <div class="table-section">
        <h2>âœï¸ à¸šà¸±à¸™à¸—à¸¶à¸à¸à¸²à¸£à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢ (à¸¥à¹ˆà¸²à¸ªà¸¸à¸” 20 à¸£à¸²à¸¢à¸à¸²à¸£)</h2>
        <table>
          <tr>
            <th>à¸§à¸±à¸™à¸—à¸µà¹ˆ</th>
            <th>à¸›à¸£à¸°à¹€à¸ à¸—</th>
            <th>à¸à¸´à¸ˆà¸à¸£à¸£à¸¡</th>
            <th>à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”</th>
            <th>à¹à¸„à¸¥à¸­à¸£à¸µà¹ˆ</th>
            <th>à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸</th>
          </tr>
          <% workout_logs.forEach(w => { %>
            <tr>
              <td><%= w.date.toISOString().slice(0,10) %></td>
              <td>
                <span class="badge-type <%= w.type %>">
                  <%= w.type === 'weight' ? 'ğŸ‹ï¸ à¹€à¸§à¸—' : 'ğŸƒ à¸§à¸´à¹ˆà¸‡' %>
                </span>
              </td>
              <td><%= w.exercise %></td>
              <td>
                <% if (w.type === 'weight') { %>
                  <%= w.weight ? w.weight + ' kg' : '' %>
                  <%= w.sets ? w.sets + ' à¹€à¸‹à¸•' : '' %>
                  <%= w.reps ? w.reps + ' à¸„à¸£à¸±à¹‰à¸‡' : '' %>
                <% } else { %>
                  <%= w.duration ? w.duration + ' à¸™à¸²à¸—à¸µ' : '' %>
                  <%= w.distance ? w.distance + ' km' : '' %>
                <% } %>
              </td>
              <td><%= w.calories || '-' %></td>
              <td><%= w.note || '-' %></td>
            </tr>
          <% }) %>
        </table>
      </div>
    </div>
  </div>

  <script>
    // Toggle workout form fields based on type
    const workoutType = document.getElementById('workout-type');
    const weightFields = document.querySelector('.weight-fields');
    const cardioFields = document.querySelector('.cardio-fields');

    function toggleWorkoutFields() {
      if (workoutType.value === 'weight') {
        weightFields.style.display = 'flex';
        cardioFields.style.display = 'none';
        weightFields.querySelectorAll('input').forEach(i => i.required = false);
        cardioFields.querySelectorAll('input').forEach(i => i.required = false);
      } else {
        weightFields.style.display = 'none';
        cardioFields.style.display = 'flex';
        weightFields.querySelectorAll('input').forEach(i => i.required = false);
        cardioFields.querySelectorAll('input').forEach(i => i.required = false);
      }
    }

    toggleWorkoutFields();
    workoutType.addEventListener('change', toggleWorkoutFields);

    // Dark Mode Toggle
    const themeToggle = document.querySelector('.theme-toggle');
    const body = document.body;
    
    const savedTheme = localStorage.getItem('theme') || 'dark';
    if (savedTheme === 'light') {
      body.classList.remove('dark-mode');
    }
    
    themeToggle?.addEventListener('click', () => {
      body.classList.toggle('dark-mode');
      const newTheme = body.classList.contains('dark-mode') ? 'dark' : 'light';
      localStorage.setItem('theme', newTheme);
    });

    // Language Toggle
    const langToggle = document.querySelector('.lang-toggle');
    const translations = {
      th: {
        title: 'ğŸ’° Life Dashboard',
        financeGroup: 'ğŸ’° à¸à¸²à¸£à¹€à¸‡à¸´à¸™',
        healthGroup: 'ğŸ’ª à¸ªà¸¸à¸‚à¸ à¸²à¸',
        stocksGroup: 'ğŸ“ˆ à¸«à¸¸à¹‰à¸™',
        goalsGroup: 'ğŸ¯ à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢',
        overview: 'à¸ à¸²à¸à¸£à¸§à¸¡',
        transactions: 'à¸˜à¸¸à¸£à¸à¸£à¸£à¸¡',
        debts: 'à¸«à¸™à¸µà¹‰à¸ªà¸´à¸™',
        fixedExpenses: 'à¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢à¸„à¸‡à¸—à¸µà¹ˆ',
        categories: 'à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ',
        settings: 'à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²',
        workout: 'à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢',
        portfolio: 'à¸à¸­à¸£à¹Œà¸•à¹‚à¸Ÿà¸¥à¸´à¹‚à¸­',
        goals: 'à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢',
        pageTitle: 'ğŸ’ª à¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£à¸ªà¸¸à¸‚à¸ à¸²à¸à¹à¸¥à¸°à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢'
      },
      en: {
        title: 'ğŸ’° Life Dashboard',
        financeGroup: 'ğŸ’° Finance',
        healthGroup: 'ğŸ’ª Health',
        stocksGroup: 'ğŸ“ˆ Stocks',
        goalsGroup: 'ğŸ¯ Goals',
        overview: 'Overview',
        transactions: 'Transactions',
        debts: 'Debts',
        fixedExpenses: 'Fixed Expenses',
        categories: 'Categories',
        settings: 'Settings',
        workout: 'Workout',
        portfolio: 'Portfolio',
        goals: 'Goals',
        pageTitle: 'ğŸ’ª Health & Workout Management'
      }
    };

    let currentLang = localStorage.getItem('lang') || 'th';
    
    function updateLanguage(lang) {
      const t = translations[lang];
      document.querySelector('.sidebar-header h2').textContent = t.title;
      document.querySelectorAll('.nav-group-title')[0].textContent = t.financeGroup;
      document.querySelectorAll('.nav-group-title')[1].textContent = t.healthGroup;
      document.querySelectorAll('.nav-group-title')[2].textContent = t.stocksGroup;
      document.querySelectorAll('.nav-group-title')[3].textContent = t.goalsGroup;
      
      const navItems = document.querySelectorAll('.nav-item');
      navItems[0].innerHTML = '<span>ğŸ“Š</span> ' + t.overview;
      navItems[1].innerHTML = '<span>ğŸ§¾</span> ' + t.transactions;
      navItems[2].innerHTML = '<span>âš ï¸</span> ' + t.debts;
      navItems[3].innerHTML = '<span>ğŸ“Œ</span> ' + t.fixedExpenses;
      navItems[4].innerHTML = '<span>ğŸ·ï¸</span> ' + t.categories;
      navItems[5].innerHTML = '<span>âš™ï¸</span> ' + t.settings;
      navItems[6].innerHTML = '<span>ğŸƒ</span> ' + t.workout;
      navItems[7].innerHTML = '<span>ğŸ’¹</span> ' + t.portfolio;
      navItems[8].innerHTML = '<span>ğŸ“</span> ' + t.goals;
      
      document.querySelector('.top-bar h1').textContent = t.pageTitle;
      
      langToggle.textContent = lang === 'th' ? 'ğŸ‡¬ğŸ‡§ EN' : 'ğŸ‡¹ğŸ‡­ TH';
    }

    updateLanguage(currentLang);
    
    langToggle?.addEventListener('click', () => {
      currentLang = currentLang === 'th' ? 'en' : 'th';
      localStorage.setItem('lang', currentLang);
      updateLanguage(currentLang);
    });
  </script>
</body>
</html>
